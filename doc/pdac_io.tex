
\section{Input and Output Files}
\label{section:files}

IO \PDAC philosofy
bla bla bla bla
bla bla bla bla
bla bla bla bla
bla bla bla bla
bla bla bla bla
bla bla bla bla
bla bla bla bla
see Section \ref{section:formats}.


\subsection{File formats}
\label{section:formats}

\subsubsection{pdac.dat file}

\subsubsection{?? pdac.xml ???}

\subsubsection{pdac.log file}

\subsubsection{pdac.res file}

\subsubsection{pdac.tst file}

\subsubsection{pdac.err file}

\subsection{\PDAC\ configuration parameters}
\label{section:file_config}

\subsubsection{Input files}

\begin{itemize}
\item
\PDACCONF{coordinates}{coordinate PDB file}{UNIX filename}
{\label{param:coordinates}
%% This parameter is {\it required\/} for every simulation.  
The PDB file containing initial position coordinate data.  
%% This can be either an absolute or relative path name.  
Note that path names can be either absolute or relative.  
Only one value may be specified.}

\item
\PDACCONF{structure}{PSF file}{UNIX filename}
{\label{param:structure}
%% This parameter is {\it required\/} for every simulation.
The X-PLOR format PSF file describing the molecular 
system to be simulated.  
Only one value may be specified.}

\item
\PDACCONF{parameters}{parameter file}{UNIX filename}
{\label{param:parameters}
A CHARMM19 or CHARMM22 parameter file that defines all or part 
of the parameters necessary for the molecular system to be simulated.  
At least one parameter file must be specified for each simulation.  
Multiple definitions (but only one file per definition)
are allowed for systems that require more than one parameter file.
The files will be read 
in the order that they appear in the configuration file.  If duplicate
parameters are read, a warning message is printed and the last
parameter value read is used.  Thus, the order that files are read 
can be important in cases where duplicate values appear in 
separate files.}

\item
\PDACCONFWDEF{paraTypeXplor}{Is the parameter file in X-PLOR format?}{{\tt on} or {\tt off}}{{\tt on}}
{Specifies whether or not the parameter file(s) are in X-PLOR format.
 X-PLOR format is the default for parameter files!
 Caveat: The PSF file should be also constructed with X-PLOR in
 case of an X-PLOR parameter file because X-PLOR stores information
 about the multiplicity of dihedrals in the PSF file. See the X-PLOR
 manual for details.}

\item
\PDACCONFWDEF{paraTypeCharmm}{Is the parameter file in CHARMM format?}{{\tt on} or {\tt off}}{{\tt off}}
{Specifies whether or not the parameter file(s) are in CHARMM format.
 X-PLOR format is the default for parameter files!
 Caveat: The information about multiplicity of dihedrals will be
 obtained directly from the parameter file, and the full multiplicity
 will be used (same behavior as in CHARMM). If the PSF file originates
 from X-PLOR, consecutive multiple entries for the same dihedral 
 (indicating the dihedral multiplicity for X-PLOR) will be ignored.}

\item
\PDACCONF{velocities}{velocity PDB file}{UNIX filename}
{\label{param:velocities}
The PDB file containing the initial velocities for all 
atoms in the simulation.  
This is typically a restart file or final velocity file written 
by \PDAC\ during a previous simulation.  
Either the {\tt temperature} 
or the {\tt velocities}/{\tt binvelocities} 
option must be defined to determine an initial set of velocities.  
Both options cannot be used together.}

\item
\PDACCONF{binvelocities}{binary velocity file}{UNIX filename}
{\label{param:binvelocities}
The binary file containing initial velocities for all 
atoms in the simulation.  
A binary velocity file is created as output from \PDAC\ 
by activating the {\tt binaryrestart} or {\tt binaryoutput} options.  
The {\tt binvelocities} option should be used as 
an alternative to {\tt velocities}.  
Either the {\tt temperature} 
or the {\tt velocities}/{\tt binvelocities} 
option must be defined to determine an initial set of velocities.  
Both options cannot be used together.  
}

\item
\PDACCONF{bincoordinates}{binary coordinate restart file}{UNIX filename}
{
The binary restart file containing initial position 
coordinate data.  
A binary coordinate restart file is created as output from \PDAC\ 
by activating the {\tt binaryrestart} or {\tt binaryoutput} options.  
Note that, in the current implementation at least, 
the {\tt bincoordinates} option must be used in addition 
to the {\tt coordinates} option, 
but the positions specified by {\tt coordinates} will then be ignored.  
}

\item
\PDACCONF{cwd}{default directory}{UNIX directory name}
{The default directory for input and output files.  
If a value is given, all filenames that 
do not begin with a / are assumed to be in this directory.  
For example, if {\tt cwd} is set to {\tt /scr}, then a
filename of {\tt outfile} would be modified to {\tt /scr/outfile}
while a filename of {\tt /tmp/outfile} would remain unchanged.
If no value for {\tt cwd} is specified, than all filenames are 
left unchanged {\em but are assumed to be relative to the directory
which contains the configuration file given on the command line}.}

\end{itemize}

\subsubsection{Output files}

\begin{itemize}
\item
\PDACCONF{outputname}{output PDB file}{UNIX filename prefix}
{\label{param:outputname}
%% This parameter is {\it required\/} for every simulation.
At the end of every simulation, \PDAC\ writes two PDB files, one 
containing the final coordinates and another containing 
the final velocities of all atoms in the simulation.  
This option specifies the file prefix for these two files.  
The position coordinates will be saved to a file named as this prefix 
with {\tt .coor} appended.  
The velocities will be saved to a file 
named as this prefix with {\tt .vel} appended.  
For example, 
if the prefix specified using this option was {\tt /tmp/output}, 
then the two files 
would be {\tt /tmp/output.coor} and {\tt /tmp/output.vel}.}

\item
\PDACCONFWDEF{binaryoutput}{use binary output files?}
{{\tt yes} or {\tt no}}{{\tt yes}}
{
Activates the use of binary output files.  
If this option is set to {\tt yes}, then the final output files 
will be written in binary rather than PDB format.  
Binary files preserve more accuracy between \PDAC\ restarts 
than ASCII PDB files, 
but the binary files are not guaranteed to be transportable 
between computer architectures.  
(The utility program {\tt flipbinpdb} is provided with the Linux/Intel
version to reformat these files.)
}

\item
\PDACCONF{restartname}{restart files}{UNIX filename prefix}
{
The prefix to use for restart filenames.  
\PDAC\ produces PDB restart files 
that store the current positions and velocities of all 
atoms at some step of the simulation.  
This option specifies the prefix to use for restart 
files in the same way that {\tt outputname} 
specifies a filename prefix for the final
positions and velocities.  
If {\tt restartname} is defined then
the parameter {\tt restartfreq} must also be defined.}

\item
\PDACCONF{restartfreq}{frequency of restart file generation}{positive integer}
{
The number of timesteps between the generation of restart files.  
If {\tt restartfreq} is defined, then {\tt restartname} 
must also be defined.}

\item
\PDACCONFWDEF{restartsave}{use timestep in restart filenames?}
{{\tt yes} or {\tt no}}{{\tt no}}
{
Appends the current timestep to the restart filename prefix, producing
a sequence of restart files rather than only the last version written.
}

\item
\PDACCONFWDEF{binaryrestart}{use binary restart files?}
{{\tt yes} or {\tt no}}{{\tt yes}}
{
Activates the use of binary restart files.  
If this option is set to {\tt yes}, then the restart files
will be written in binary rather than PDB format.  
Binary files preserve more accuracy between \PDAC\ restarts 
than ASCII PDB files, 
but the binary files are not guaranteed to be transportable 
between computer architectures.  
(The utility program {\tt flipbinpdb} is provided with the Linux/Intel
version to reformat these files.)
}

\item
\PDACCONF{DCDfile}{coordinate trajectory output file}{UNIX filename}
{
The binary DCD position coordinate trajectory filename.  
This file stores the trajectory of all atom position coordinates 
using the same format (binary DCD) as X-PLOR.  
If {\tt DCDfile} is defined, then {\tt DCDfreq} must also be defined.  
}

\item
\PDACCONF{DCDfreq}
{timesteps between writing coordinates to trajectory file}
{positive integer}
{
The number of timesteps between the writing of position coordinates 
to the trajectory file.  
The initial positions will not be included in the trajectory file.
}

\item
\PDACCONFWDEF{DCDUnitCell}{write unit cell data to dcd file?}
{{\tt yes} or {\tt no}}{{\tt no}}
{
If this option is set to {\tt yes}, then DCD files will contain unit
cell information in the style of Charmm DCD files.
}

\item
\PDACCONF{velDCDfile}{velocity trajectory output file}{UNIX filename}
{
The binary DCD velocity trajectory filename.  
This file stores the trajectory of 
all atom velocities using the same format (binary DCD) as X-PLOR.  
If {\tt velDCDfile} is defined, then {\tt velDCDfreq} must also 
be defined.  
}

\item
\PDACCONF{velDCDfreq}
{timesteps between writing velocities to trajectory file}
{positive integer}
{
The number of timesteps between the writing of 
velocities to the trajectory file.  
The initial velocities will not be included in the trajectory file.
}

\end{itemize}

\subsubsection{Standard output}

\PDAC logs a variety of summary information to standard output.
The standard units used by PDAC are
\index{units used for output}
Angstroms for length, kcal/mol for energy,
Kelvin for temperature, and bar for pressure.
Wallclock or CPU times are given in seconds unless otherwise noted.

\index{BOUNDARY energy}
BOUNDARY energy is from spherical boundary conditions and harmonic restraints,
\index{MISC energy}
while MISC energy is from external electric fields and various steering forces.
TOTAL is the sum of the various potential energies, and the KINETIC energy.
\index{TOTAL2 energy}
TOTAL2 uses a slightly different kinetic energy that is better conserved
during equilibration in a constant energy ensemble.
\index{TOTAL3 energy}
TOTAL3 is another variation with much smaller short-time fluctuations that
is also adjusted to have the same running average as TOTAL2.
Defects in constant energy simulations are much easier to spot in TOTAL3
than in TOTAL or TOTAL2.

PRESSURE is the pressure calculated based on individual atoms, while
\index{GPRESSURE}
GPRESSURE incorporates hydrogen atoms into the heavier atoms to which
they are bonded, producing smaller fluctuations.
\index{TEMPAVG}
\index{PRESSAVG}
\index{GPRESSAVG}
The TEMPAVG, PRESSAVG, and GPRESSAVG are the average of temperature and
pressure values since the previous ENERGY output; for the first step
in the simulation they will be identical to TEMP, PRESSURE, and GPRESSURE.

\begin{itemize}
\item
\PDACCONFWDEF{outputEnergies}
{timesteps between energy output}{positive integer}{1}
{
The number of timesteps between each energy output of \PDAC.  
This value
specifies how often \PDAC\ should output the current energy 
values to {\bf stdout} (which can be redirected to a file).  
By default, this is done every step.  
For long simulations, 
the amount of output generated by \PDAC\ can be greatly reduced 
by outputting the energies only occasionally.  
}

\item
\PDACCONFWDEF{outputMomenta}
{timesteps between momentum output}{nonnegative integer}{0}
{
The number of timesteps between each momentum output of \PDAC.
If specified and nonzero, linear and angular momenta will be
output to {\bf stdout}.
}

\item
\PDACCONFWDEF{outputPressure}
{timesteps between pressure output}{nonnegative integer}{0}
{
The number of timesteps between each pressure output of \PDAC.
If specified and nonzero, atomic and group pressure tensors
will be output to {\bf stdout}.
}

\item
\PDACCONFWDEF{outputTiming}
{timesteps between timing output}{nonnegative integer}{0}
{
The number of timesteps between each timing output of \PDAC.
If specified and nonzero, CPU and wallclock times will be
output to {\bf stdout}.
These data are from node 0 only; CPU times for other nodes
may vary.
}

\end{itemize}


\subsection{AMBER force field parameters}

AMBER format PARM file and coordinate file can be read by PDAC,
which allows one to use AMBER force field to carry out all types
of simulations that PDAC has supported. PDAC can read PARM files
in either the format used in AMBER 6 or the new format
defined in AMBER 7. The output of
the simulation (restart file, DCD file, etc.) will still be in
traditional format that has been used in PDAC.

\begin{itemize}

\item
\PDACCONFWDEF{amber}{use AMBER format force field?}{yes or no}{no}
{
If {\tt amber} is set to on, then {\tt parmfile} must be defined,
and {\tt structure} and {\tt parameters} should not be defined.
}

\item
\PDACCONF{parmfile}{AMBER format PARM file}{UNIX filename}
{
This file contains complete topology and parameter information of
the system.
}

\item
\PDACCONF{ambercoor}{AMBER format coordinate file}{UNIX filename}
{
This file contains the coordinates of all the atoms. Note that
{\tt coordinates} can also be used for PDB format coordinate
file. When {\tt amber} is set to on, either {\tt ambercoor}
or {\tt coordinates} must be defined, but not both.
}

\item
\PDACCONFWDEF{readexclusions}{Read exclusions from PARM file?}{yes or no}{yes}
{
PARM file explicitly gives complete exclusion (including 1-4
exclusions) information. When {\tt readexclusions} is set to on,
PDAC will read all exclusions from PARM file and will not add any
more; alternatively, if {\tt readexclusions} is set to
off, PDAC will ignore the exclusions in PARM file and will
automatically generate them according to the
exclusion policy specified by {\tt exclude}.
}

\item
\PDACCONFWDEF{scnb}{VDW 1-4 scaling factor}{decimal $\geq$ 1.0}{2.0}
{
Same meaning as SCNB in AMBER. Note that in PDAC, 1-4 vdw
interactions are DIVIDED by {\tt scnb}, whereas 1-4 electrostatic
interactions are MULTIPLIED by {\tt 1-4scaling}. So
{\tt 1-4scaling} should be set to the inverse of SCEE value used
in AMBER.
}

\end{itemize}

\noindent Caveat:

\noindent 1. Polarizable parameters in AMBER are not supported.

\noindent 2. PDAC does not support the 10-12 potential terms in
some old AMBER versions. When non-zero 10-12 parameter is
encountered in PARM file, PDAC will terminate.

\noindent 3. PDAC has several exclusion policy options, defined
by {\tt exclude}. The way AMBER dealing with exclusions
corresponds to the ``scaled1-4'' in PDAC. So for simulations using
AMBER force field, one would specify ``exclude scaled1-4'' in the
configuration file, and set {\tt 1-4scaling} to the inverse value
of SCEE as would be used in AMBER.

\noindent 4. PDAC does not read periodic box lengths in PARM or
coordinate file. They must be explicitly specified in PDAC
configuration file.

\noindent 5. By default, PDAC applies switching functions to
the non-bond interactions within the cutoff distance,
which helps to improve energy conservation, while AMBER does not
use switching functions so it simply
truncates the interactions at cutoff. However, if ``authentic''
AMBER cutoff simulations are desired, the switching functions
could be turned off by specifying ``switching off'' in PDAC
configuration file.

\noindent 6. When SHAKE is applied to water molecules, PDAC
constrains the two O-H bonds and the H-O-H angle, which produces
the same result as constraining the additional H-H bond. But in
some AMBER models, water is defined by three real bonds and no
angle. In this case PDAC will apply SHAKE only to the two O-H
bonds and not to the angle or the H-H bond (because the angle is
not defined). Thus, when
SHAKE is used along with this kind of water model, difference
would be expected between PDAC and AMBER.

\noindent 7. PDAC and AMBER may have different default values for
some parameters (e.g., the tolerance of SHAKE). One should check
other sections of this manual for accurate descriptions
of the PDAC options.
\newline

Following are two examples of the PDAC configuration file to read
AMBER force field and carry out simulation. They may help users
to select proper PDAC options for AMBER force field. For the
convenience of AMBER users, the AMBER~6 sander input files are
given in the left for comparison, which would accomplish similar
tasks in AMBER.
\newline

\noindent Example~1: Non-periodic boundary system, cutoff simulation

\begin{verbatim}
---AMBER----      ---PDAC---

 TITLE
 &cntrl
  ntb=0, igb=2,   # non-periodic, use cutoff for non-bond
  nstlim=1000,    numsteps       1000  # Num of total steps
  ntpr=50,        outputEnergies 50  # Energy output frequency
  ntwr=50,        restartfreq    50  # Restart file frequency
  ntwx=100,       DCDfreq        100  # Trajectory file frequency
  dt=0.001,       timestep       1  # in unit of fs (This is default)
  tempi=0.,       temperature    0  # Initial temp for velocity assignment
  cut=10.,        cutoff         10
                  switching      off  # Turn off the switching functions
  scee=1.2,       exclude        scaled1-4
                  1-4scaling     0.833333  # =1/1.2, default is 1.0
  scnb=2.0        scnb           2  # This is default
 &end
                  amber          on  # Specify this is AMBER force field
                  parmfile       prmtop  # Input PARM file
                  ambercoor      inpcrd  # Input coordinate file
                  outputname     md  # Prefix of output files
\end{verbatim}

\noindent Example~2: Periodic boundary system, PME, NVE ensemble,
using SHAKE algorithm

\begin{verbatim}
---AMBER----      ---PDAC---

 TITLE
 &cntrl
  ntc=2, ntf=2,   # SHAKE to the bond between each hydrogen and it mother atom
                  rigidBonds     all
  tol=0.0005,     rigidTolerance 0.0005  # Default is  0.00001
  nstlim=500,     numsteps       500  # Num of total steps
  ntpr=50,        outputEnergies 50  # Energy output frequency
  ntwr=100,       restartfreq    100  # Restart file frequency
  ntwx=100,       DCDfreq        100  # Trajectory file frequency
  dt=0.001,       timestep       1  # in unit of fs (This is default)
  tempi=300.,     temperature    300  # Initial temp for velocity assignment
  cut=9.,         cutoff         9
                  switching      off  # Turn off the switching functions
 &end
 &ewald           PME            on  # Use PME for electrostatic calculation
                  # Orthogonal periodic box size
  a=62.23,        cellBasisVector1   62.23  0  0
  b=62.23,        cellBasisVector2   0  62.23  0
  c=62.23,        cellBasisVector3   0  0  62.23
  nfft1=64,       PMEGridSizeX   64
  nfft2=64,       PMEGridSizeY   64
  nfft3=64,       PMEGridSizeZ   64
  ischrgd=1,      # PDAC doesn't force neutralization of charge
 &end
                  amber          on  # Specify this is AMBER force field
                  parmfile       FILENAME  # Input PARM file
                  ambercoor      FILENAME  # Input coordinate file
                  outputname     PREFIX  # Prefix of output files
                  exclude        scaled1-4
                  1-4scaling     0.833333  # =1/1.2, default is 1.0
\end{verbatim}

\subsection{GROMACS force field paramets}

\PDAC\ has the ability to load GROMACS ASCII topology (.top) and
coordinate (.gro) files, which allows you to run most GROMACS
simulations in \PDAC.  All simulation output will still be in the
traditional \PDAC\ formats.

\begin{itemize}
\item
\PDACCONFWDEF{gromacs}{use GROMACS format force field?}{on or off}{off}
{
If {\tt gromacs} is set to on, then {\tt grotopfile} must be defined,
and {\tt structure} and {\tt parameters} should not be defined.
}
\item
\PDACCONF{grotopfile}{GROMACS format topology/parameter file}{UNIX filename}
{
This file contains complete topology and parameter information of
the system.
}

\item
\PDACCONF{grocoorfile}{GROMACS format coordinate file}{UNIX filename}
{
This file contains the coordinates of all the atoms. Note that
{\tt coordinates} can also be used for PDB format coordinate
file. When {\tt gromacs} is set to {\tt on}, either {\tt grocoorfile}
or {\tt coordinates} must be defined, but not both.
}
\end{itemize}

\noindent However, \PDAC\ does not have support for many GROMACS-specific
options:

\begin{itemize}

\item Dummies (fake atoms with positions generated from the positions
of real atoms) are not supported.
\item The GROMACS \verb^pairs^ section, where explicit 1--4 parameters
are given between pairs of atoms, is not supported, since \PDAC\
calculates its 1--4~interactions exclusively by type.
\item Similarly, \verb^exclusions^ are not supported.  The biggest
problem here is that GROMACS RB dihedrals are supposed to imply
exclusions, but \PDAC\ does not support this.
\item Constraints, restraints, and \verb^settles^ are not
implemented in \PDAC.
\item In some cases, it may not work to override some but not all of
the parameters for a bond, atom, etc.  In this case, PDAC will
generate an error and stop.  The parser will sometimes not tolerate
correct GROMACS files or fail to detect errors in badly formatted
files.
\item \PDAC\ does not support all the types of bond potentials that
exist in GROMACS, but approximates them with harmonic or sinusoidal
potentials.
\item \PDAC\ does not read periodic box lengths in the
coordinate file. They must be explicitly specified in the \PDAC\
configuration file.

\end{itemize}

